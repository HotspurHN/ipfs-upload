const fs = require('fs');
const ipfsAPI = require('ipfs-api');

const jsonFiles = [];
const ipfs = ipfsAPI('localhost', '5001', { protocol: 'http' });
const svg = `<svg width="156" height="39" viewBox="0 0 156 39" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M57.929 9.27699L63.1087 23.902L68.2607 9.27699H73.7173V29.4418H69.5487V23.9297L69.9641 14.4151L64.5213 29.4418H61.6683L56.2393 14.429L56.6548 23.9297V29.4418H52.5V9.27699H57.929Z" fill="{0}"/>
<path d="M81.7639 29.4418H77.609V9.27699H81.7639V29.4418Z" fill="{0}"/>
<path d="M93.0927 16.2294L96.8736 9.27699H101.652L95.7795 19.2763L101.804 29.4418H96.9705L93.0927 22.3785L89.2149 29.4418H84.3814L90.4059 19.2763L84.5338 9.27699H89.3118L93.0927 16.2294Z" fill="{0}"/>
<path d="M120.113 19.8164C120.113 21.8015 119.762 23.5419 119.06 25.0376C118.359 26.5334 117.352 27.6875 116.041 28.5C114.739 29.3125 113.244 29.7187 111.554 29.7187C109.883 29.7187 108.392 29.3171 107.081 28.5138C105.77 27.7106 104.754 26.5657 104.034 25.0792C103.314 23.5834 102.949 21.8661 102.94 19.9272V18.93C102.94 16.945 103.295 15.1999 104.006 13.695C104.726 12.1808 105.737 11.022 107.039 10.2187C108.35 9.40625 109.846 9 111.526 9C113.207 9 114.698 9.40625 116 10.2187C117.311 11.022 118.322 12.1808 119.033 13.695C119.753 15.1999 120.113 16.9403 120.113 18.9162V19.8164ZM115.903 18.9023C115.903 16.788 115.524 15.1815 114.767 14.0827C114.01 12.984 112.93 12.4347 111.526 12.4347C110.132 12.4347 109.056 12.9794 108.299 14.0689C107.542 15.1491 107.159 16.7372 107.15 18.8331V19.8164C107.15 21.8754 107.528 23.4727 108.286 24.6083C109.043 25.744 110.132 26.3118 111.554 26.3118C112.948 26.3118 114.019 25.767 114.767 24.6776C115.515 23.5788 115.893 21.9815 115.903 19.8857V18.9023Z" fill="{0}"/>
<path d="M130.597 22.06H127.287V29.4418H123.132V9.27699H130.625C133.007 9.27699 134.844 9.80788 136.137 10.8697C137.429 11.9315 138.076 13.4318 138.076 15.3707C138.076 16.7464 137.776 17.8959 137.175 18.8192C136.585 19.7333 135.684 20.4627 134.475 21.0075L138.837 29.2479V29.4418H134.378L130.597 22.06ZM127.287 18.6946H130.639C131.682 18.6946 132.49 18.4315 133.062 17.9052C133.635 17.3697 133.921 16.6357 133.921 15.7031C133.921 14.7521 133.648 14.0043 133.104 13.4595C132.568 12.9148 131.742 12.6424 130.625 12.6424H127.287V18.6946Z" fill="{0}"/>
<path d="M155.734 12.6424H149.557V29.4418H145.402V12.6424H139.308V9.27699H155.734V12.6424Z" fill="{0}"/>
<path d="M18.75 10.5L37.5 0V31.5L25.5 39V21L18.75 24.75V10.5Z" fill="{1}"/>
<path d="M18.75 10.5L0 0V31.5L12 39V21L18.75 24.75V10.5Z" fill="{2}"/>
</svg>`;
const json = {
    "description": "MIXORT Logo",
    "image": "",
    "name": "MIXORT",
    "attributes": [
        {
            "trait_type": "TextColor",
            "value": ""
        },
        {
            "trait_type": "LogoColor1",
            "value": ""
        },
        {
            "trait_type": "LogoColor2",
            "value": ""
        }
    ]
};

let colors = [
    '#FFCB00',
    '#4C4C4C',
    '#39AA1D',
    '#57C335',
    '#00baf7',
    '#ebebeb',
    '#000',
    '#e75300'
];

const main = async () => {
    for (let j = 0; j < 100; j++) {
        let s = svg;
        const logoColors = [];
        for (let i = 0; i < 3; i++) {
            let color = colors[Math.random() * colors.length | 0];
            logoColors.push(color);
            s = s.replaceAll(`{${i}}`, color);
        }
        const jsonFile = Object.assign({}, json);
        jsonFile.attributes[0].value = logoColors[0];
        jsonFile.attributes[1].value = logoColors[1];
        jsonFile.attributes[2].value = logoColors[2];

        const file = await ipfs.files.add(Buffer.from(s, "utf-8"));
        jsonFile.image = `ipfs://${file[0].path}`;
        const fileJson = await ipfs.files.add(Buffer.from(JSON.stringify(jsonFile), "utf-8"));
        jsonFiles.push(fileJson[0].path);
    }
    fs.writeFileSync('ipfs.json', JSON.stringify(jsonFiles));
};
main();